# Migration `20201122205513-added-visibility`

This migration has been generated by Taliesin at 11/22/2020, 8:55:13 PM.
You can check out the [state of the schema](./schema.prisma) after the migration.

## Database Steps

```sql
ALTER TABLE "public"."Answer" DROP CONSTRAINT "Answer_pollId_fkey"

ALTER TABLE "public"."Answer" DROP CONSTRAINT "Answer_voterId_fkey"

ALTER TABLE "public"."Answer" DROP COLUMN "pollId",
DROP COLUMN "voterId",
ADD COLUMN "Poll" text   

ALTER TABLE "public"."Poll" ADD COLUMN "visibility" text   NOT NULL 

ALTER TABLE "public"."Voter" ADD COLUMN "Answers" text []  

ALTER TABLE "public"."Answer" ADD FOREIGN KEY ("Poll")REFERENCES "public"."Poll"("id") ON DELETE SET NULL ON UPDATE CASCADE
```

## Changes

```diff
diff --git schema.prisma schema.prisma
migration 20201010193500-init..20201122205513-added-visibility
--- datamodel.dml
+++ datamodel.dml
@@ -3,19 +3,17 @@
 }
 datasource db {
   provider = "postgresql"
-  url = "***"
+  url = "***"
 }
 model Answer {
-  answer_string String
-  id            String  @id
-  votes         Int?    @default(0)
-  pollId        String?
-  voterId       String?
-  Poll          Poll?   @relation(fields: [pollId], references: [id])
-  Voter         Voter?  @relation(fields: [voterId], references: [id])
+  answer_string     String
+  id                String  @id
+  votes             Int?    @default(0)
+  Poll              String?
+  Poll_AnswerToPoll Poll?   @relation(fields: [Poll], references: [id])
 }
 model PendingEmail {
   answers String[]
@@ -24,22 +22,23 @@
   created DateTime @default(now())
 }
 model Poll {
-  created  DateTime? @default(now())
-  end_date DateTime
-  id       String    @id
-  options  String
-  question String
-  title    String
-  voters   String[]
-  voterId  String?
-  Answers  Answer[]
-  password String
+  created    DateTime? @default(now())
+  end_date   DateTime
+  id         String    @id
+  options    String
+  question   String
+  title      String
+  voters     String[]
+  voterId    String?
+  Answers    Answer[]
+  visibility String
+  password   String
 }
 model Voter {
   email   String?  @unique
   id      String   @id
   ip      String
-  answers Answer[]
+  Answers String[]
 }
```


